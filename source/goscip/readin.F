C
C     =================
      SUBROUTINE READIN
C     =================
      IMPLICIT REAL*8 (A-H, O-Z)
C
      INCLUDE 'param.inc'
      INCLUDE 'common.inc'
      INCLUDE 'general.inc'
C
      CHARACTER*14 REPN(16)
C
      LOGICAL TWOC
      INTEGER REFDET,IRPMO(N1)
      REAL*8 SELPOP
C
      NAMELIST/CI/NELEC,REFDET,IREFE,IPRNT,BREIT
      NAMELIST/GENERAL/TWOC
      NAMELIST/POPAN/THRESH,DEGEN,SELPOP
C
      MRCONEE=75
C
      OPEN (MRCONEE,FILE='MRCONEE',FORM='UNFORMATTED')
      READ (MRCONEE) NORB,BREIT,ECORE
      IF (NORB.GT.N1) CALL Q2JOB(3,'P.READIN','N1',NORB)
      READ (MRCONEE) NSYMRP,(REPN(IRP),IRP=1,NSYMRP)
      READ (MRCONEE) NREP,(REPNA(IRP),IRP=1,2*NREP)
      READ (MRCONEE) ((MULTB(I,J),I=1,2*NREP),J=1,2*NREP)
      READ (MRCONEE) (IRPMO(IMO),IRPAMO(IMO),EPS(IMO),IMO=1,NORB)
      READ (MRCONEE)
     & ((ONER(IMO,JMO),ONEI(IMO,JMO),JMO=1,NORB),IMO=1,NORB)
      CLOSE (MRCONEE)
C
      OPEN (5, FILE='MOLFDIR.INP', FORM='FORMATTED')
      NELEC=0
      IPRNT=0
      REFDET=0
      IREFE=0
      CALL LOCATE('CI',2,ITEST)
      IF (ITEST.GT.0) READ (5,CI)
      IREF=REFDET
      IF (IREFE.LE.0) IREFE = NBITS(IREF)
      TWOC=.FALSE.
      CALL LOCATE('GENERAL',7,ITEST)
      IF (ITEST.GT.0) READ(5,GENERAL)
      WRITE(6,GENERAL)
C
      THRESH=1.0D-3
      DEGEN=1.0D-10
      SELPOP=1.0D2
      CALL LOCATE('POPAN',5,ITEST)
      IF (ITEST.GT.0) READ(5,POPAN)
      WRITE(6,POPAN)
C
      DO 250 I = 1, 2 * NREP
      MULTB(I,0) = I
  250 CONTINUE
C
      WRITE(6,1200)
      WRITE(6,1210) NELEC,IREF
      WRITE(6,1220) BREIT,ECORE,NORB
      DO 300 I=1,NORB
      WRITE(6,1230) I,REPN(IRPMO(I)),EPS(I)
 300  CONTINUE
C
      RETURN
 1200 FORMAT(//1X,'ALL INFORMATION READ FROM MRCONEE (AND INPUT)')
 1210 FORMAT(//1X,'NUMBER OF ELECTRONS: ',I4/
     +         1X,'DECIMAL REPRESENTATION OF FROZEN ORBITALS:',I4)
 1220 FORMAT(//1X,'BREIT INTERACTION INCLUDED :',T50,L1
     +        /1X,'CORE ENERGY :',T30,G20.10
     +        /1X,'NUMBER OF ACTIVE ORBITALS :',T47,I4
     +       //1X,'ORBITAL',T10,'REPRESENTATION',T32,'ORBITAL ENERGY')
 1230 FORMAT(2X,I4,T10,A14,T30,G20.10)
      END
