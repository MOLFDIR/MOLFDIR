C
C     ==================
      SUBROUTINE MFDDSLV(DAA,DOAA,FAA,FOAA,DOAC,FOAC)
C     ==================
      IMPLICIT REAL*8 (A-H, O-Z)
C
      INCLUDE 'paracom.inc'
      INCLUDE 'general.inc'
      INCLUDE 'memory.inc'
      INCLUDE 'diis.inc'
      INCLUDE 'mpif.h'
      INCLUDE 'mpidef.inc'
C
      REAL*8 DAA(*), DOAA(*), FAA(*), FOAA(*), DOAC(*), FOAC(*)
      DIMENSION ISTAT(MPI_STATUS_SIZE)
C
      IPTR1 = 1
      IPTR2 = IPTR1 + LENGTH
      IPTR3 = IPTR2 + LENGTH
      IPTR4 = IPTR3 + LENGTH
      ITEST = 0
      TIMF = 0.D0
      TIMB = 0.D0
 1002 CALL MPI_RECV(ITEST,1,MPI_INTEGER,0,16,
     &              MPI_COMM_WORLD,ISTAT,IERR)
      IF (ITEST.EQ.1) THEN
      CALL CPUUSED(SECA)
      CALL MFDFSLV(DAA(IPTR1),DAA(IPTR2),DAA(IPTR3),DAA(IPTR4),
     &             DOAA(IPTR1),DOAA(IPTR2),DOAA(IPTR3),DOAA(IPTR4),
     &             DOAC(IPTR1),DOAC(IPTR2),DOAC(IPTR3),DOAC(IPTR4),
     &             FAA(IPTR1),FAA(IPTR2),FAA(IPTR3),FAA(IPTR4),
     &             FOAA(IPTR1),FOAA(IPTR2),FOAA(IPTR3),FOAA(IPTR4),
     &             FOAC(IPTR1),FOAC(IPTR2),FOAC(IPTR3),FOAC(IPTR4))
      CALL CPUUSED(SECB)
      TIMF = TIMF + (SECB-SECA)
      ELSEIF (ITEST.EQ.2) THEN
      CALL CPUUSED(SECA)
      CALL MFDBSLV(DAA(IPTR1),DAA(IPTR2),DAA(IPTR3),DAA(IPTR4),
     &             DOAA(IPTR1),DOAA(IPTR2),DOAA(IPTR3),DOAA(IPTR4),
     &             DOAC(IPTR1),DOAC(IPTR2),DOAC(IPTR3),DOAC(IPTR4),
     &             FAA(IPTR1),FAA(IPTR2),FAA(IPTR3),FAA(IPTR4),
     &             FOAA(IPTR1),FOAA(IPTR2),FOAA(IPTR3),FOAA(IPTR4),
     &             FOAC(IPTR1),FOAC(IPTR2),FOAC(IPTR3),FOAC(IPTR4))
      CALL CPUUSED(SECB)
      TIMB = TIMB + (SECB-SECA)
      ELSEIF (ITEST.EQ.3) THEN
          CALL MFOPEN
      ELSEIF (ITEST.EQ.0) THEN
          GOTO 1003
      ELSEIF (ITEST.LT.0) THEN
          RETURN
      ENDIF
      GOTO 1002
 1003 CALL MPI_REDUCE(TIMF,DUMMY,1,MPI_DOUBLE_PRECISION,
     &                MPI_SUM,0,MPI_COMM_WORLD,IERR)
      CALL MPI_REDUCE(TIMF,DUMMY,1,MPI_DOUBLE_PRECISION,
     &                MPI_MIN,0,MPI_COMM_WORLD,IERR)
      CALL MPI_REDUCE(TIMF,DUMMY,1,MPI_DOUBLE_PRECISION,
     &                MPI_MAX,0,MPI_COMM_WORLD,IERR)
      CALL MPI_REDUCE(TIMB,DUMMY,1,MPI_DOUBLE_PRECISION,
     &                MPI_SUM,0,MPI_COMM_WORLD,IERR)
      CALL MPI_REDUCE(TIMB,DUMMY,1,MPI_DOUBLE_PRECISION,
     &                MPI_MIN,0,MPI_COMM_WORLD,IERR)
      CALL MPI_REDUCE(TIMB,DUMMY,1,MPI_DOUBLE_PRECISION,
     &                MPI_MAX,0,MPI_COMM_WORLD,IERR)
      RETURN
      END
