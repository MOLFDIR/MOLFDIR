C
      SUBROUTINE RSDENS(MCYCL,A,B,L1,IRP,IOPT)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*8 A(*), B(*)
C
      INCLUDE 'paracom.inc'
      INCLUDE 'general.inc'
C
C === THIS ROUTINE READS THE DENSITY MATRIX FROM FILE
C === IOPT = 1 : READ CLOSED SHELL
C === IOPT > 1 : READ OPEN SHELL
C
      IF (IOPT .EQ. 1) THEN
        IREC = (MCYCL - 1) * (NDCREC+NDOREC+NDTREC) + INIRP(IRP)
      ELSE 
	IF (IOPT .EQ. 2) THEN
        IREC = (MCYCL - 1) * (NDCREC+NDOREC+NDTREC) + NDCREC + 
     +         INIRP(16 + IRP)
	ELSE
	  IF (IOPT .LE. 3) THEN
	  IREC = (MCYCL-1)*(NDCREC+NDOREC+NDTREC)+NDCREC+NDOREC+
     +           INIRP(32+IRP)
          ELSE
            CALL Q2JOB(6,'RDENS: IOPT SHOULD BE 1,2 OR 3',' ',1)
          ENDIF
        ENDIF
      ENDIF
      READ(MFDENSM,REC=IREC) (A(I),B(I),I=1,L1)
      RETURN
      END
