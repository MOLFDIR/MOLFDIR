C
C     ============================
      SUBROUTINE GENFIL (IOM,ITYP)
C     ============================
      IMPLICIT REAL*8 (A-H, O-Z)
C
C     WRITE BASIS TO FILE
C
      INCLUDE 'paracom.inc'
C
      LOGICAL SESAM
      CHARACTER*15 FORMATE,FORMATC
      PARAMETER (FORMATE='(4F20.10)',FORMATC='(4F20.15)')
C
      NPR = NPRIM (IOM,ITYP)
      NCO = NCONTR (IOM,ITYP)
      INQUIRE (4,OPENED=SESAM)
      IF (.NOT.SESAM) THEN
         OPEN (4,FILE=NAMES(2),ACCESS='SEQUENTIAL',FORM='FORMATTED')
         WRITE (4,1000) NAMES(1),DATES(2),TIMES(2),FORMATE,NE,FORMATC,
     $                  NC,CHARGE,RNUC
      ENDIF
      WRITE (4,1010) IOM,ITYP+1,NPR,NCO
      WRITE (4,FORMATE) (EG (J,ITYP,IOM),J=1,NPR)
      WRITE (4,FORMATC) ((CG (J,I,ITYP,IOM),J=1,NPR),I=1,NCO)
 1000 FORMAT (A80/A10,A8,2(A10,I4),F6.1,F20.5)
 1010 FORMAT (4I4)
      END
