C
C     =================
      SUBROUTINE GENINP
C     =================
      IMPLICIT REAL*8 (A-H, O-Z)
C
C     READ INFORMATION FROM FILES MFD1OUT AND VECTORS
C
      INCLUDE 'paracom.inc'
C
      DIMENSION IPARAM(8)
      LOGICAL JDUM
#if defined (BIT64)
      CHARACTER*10 DATEX
#endif
      CHARACTER*10 VERS
      CHARACTER*80 CARD
      NAMELIST/NATORB/USENAT,FILENAM
C     -------------------
C     OPEN FILE VECTOR FILE
C     -------------------
      USENAT=.FALSE.
      CALL LOCATE('NATORB',6,ITEST)
      IF (ITEST.GT.0) READ (5,NATORB)
      IF (.NOT.USENAT) FILENAM='MFDVECA   '
      OPEN (2,FILE=FILENAM,FORM='FORMATTED',STATUS='OLD',ERR=10010)
      READ (2,1000,END=10020,ERR=10020) CARD 
      READ (2,1000,END=10020,ERR=10020) CARD
      READ (2,1006,END=10020,ERR=10020) IDUM,JDUM,TWOC
      READ (2,1000,END=10020,ERR=10020) CARD
      READ (2,1000,END=10020,ERR=10020) CARD
      READ (2,1008,END=10020,ERR=10020) NSYMRP 
      READ (2,1009,END=10020,ERR=10020) (NBLR(I),I=1,NSYMRP) 
      READ (2,1009,END=10020,ERR=10020) (NBSR(I),I=1,NSYMRP)
      READ(CARD,1001,ERR=10020) FORMAT
      IF (FORMAT.EQ.' ') FORMAT='(6F22.16)'
C     --------------------------------------
C     READ SYMMETRY INFORMATION FROM MFD1OUT
C     --------------------------------------
      OPEN( 3,FILE='MFD1OUT',STATUS='OLD',FORM='UNFORMATTED')
      REWIND  3
      CALL DAYTIME(DATES(2),TIMES(2))
#if defined (BIT64)
      READ (3)     TIMES(1),DATEX,VERS,NAMES(1)
      DATES(1) = DATEX
#else
      READ (3)     TIMES(1),DATES(1),VERS,NAMES(1)
      READ (3)     (IPARAM(I),I=1,7)
#endif
C
C     ------------------------------------------
C     CHECK THE PARAMETERS FOR INCOMPATIBILITIES
C     ------------------------------------------
C
      IF (IPARAM(1).GT.N14) CALL Q2JOB(5,'P.MFD2INP','N14',IPARAM(1))
      IF (IPARAM(5).GT.N7 ) CALL Q2JOB(5,'P.GENINP','N7' ,IPARAM(5))
      IF (IPARAM(7).GT.N12) CALL Q2JOB(5,'P.GENINP','N12',IPARAM(7))
      READ (3)      NEQ1,NEQUIV,IDUM,NEQCOM,NGAUS,NCOMB,NSYMOP,NNUCL,
     $              NSYMF,
     $              NCOEFF,NSYMRP,NWRDS1,NWRDS2,NWRDS3,NBT,NST,POTNUC
      IF (NGAUS.GT.N15) CALL Q2JOB(5,'P.GENINP','N15',NGAUS)
      READ (3)
      READ (3)      CHARGE,IDUM,IDUM,IDUM,RNUC
      READ (3)      (KCOMB(I),INDBAS(I),INDSYM,I=1,NEQUIV)
      READ (3)      (ALPHA(I),COEFF(I),I=1,NGAUS)
      READ (3)      (ICENT,ITYPE(I),(ICOMOP,J=1,NSYMOP),
     $              I=1,NCOMB),(INDCOM(I),I=1,NEQCOM)
      READ (3)      (INDORB,INDB(I),KSYMRP(I),LSYMRP(I),KSYMF,
     $              I=1,NSYMF)
      READ (3)
      READ (3)      (NBSYM(I),NBSYM1(I),NBSYM2(I),I=1,NSYMRP)
      INDCOM (NEQCOM + 1) = NCOMB
      INDBAS (NEQUIV + 1) = NGAUS
      DO 20 I=1,NSYMRP
      IF (NBSYM(I).GT.N16) CALL Q2JOB(5,'P.GENINP','N16',NBSYM(I))
   20 CONTINUE
      OPEN (55,FILE='MFDSYMC',FORM='UNFORMATTED',STATUS='OLD')
      REWIND (55)
      DO 100 I=1,NSYMF+5
	 READ (55)
  100    CONTINUE
      READ (55) (IDUM,I=1,NSYMRP),(IDUM,I=1,NSYMRP),
     +                            (IPRTNR(I),I=1,NSYMRP)
      CLOSE (55)
      RETURN
 1000 FORMAT(A)
 1001 FORMAT(A9)
 1006 FORMAT(I4,3X,L1,3X,L1)
 1008 FORMAT(I4)
 1009 FORMAT(16I4)
10010 CALL Q2JOB(1,'ERROR OPENING VECTOR FILE',' ',0)
10020 CALL Q2JOB(1,'END OR ERROR ON VECTOR FILE',' ',0)
      END
